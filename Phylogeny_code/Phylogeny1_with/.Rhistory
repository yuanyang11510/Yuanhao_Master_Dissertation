nn_nx
#3. Méthodes de parcimonie
#3.1. Parcimonie générale (branch and bound)
lx_bab <- bab(lx_phy)
lx_bab[[1]]
ggtree(lx_bab[[1]], layout = "daylight") +
geom_tiplab2() +
xlim(-25, 45) + ylim(-30, 60) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-25, 45) + ylim(-30, 60) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-100, 100) + ylim(-100, 100) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-150, 150) + ylim(-100, 100) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 150) + ylim(-100, 100) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 120) + ylim(-100, 100) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-200, 120) + ylim(-100, 100) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-200, 200) + ylim(-100, 100) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-200, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-250, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[2]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[3]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
#3.2. Parcimonie ratchet
lx_pratchet <- pratchet(lx_phy)
lx_pratchet <- acctran(lx_pratchet, lx_phy)
lx_pratchet
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-70, 30) + ylim(-35, 45) +
theme_tree()
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-150, 100) + ylim(-150, 100) +
theme_tree()
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-150, 100) + ylim(-250, 200) +
theme_tree()
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-150, 100) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_bab[[1]], layout = "daylight") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[1]], layout = "daylight") +
geom_tiplab2() +
xlim(-100, 150) + ylim(-350, 50) +
theme_tree()
ggtree(lx_bab[[1]], layout = "daylight") +
geom_tiplab2() +
xlim(-200, 50) + ylim(-350, 50) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[1]], layout = "daylight") +
geom_tiplab2() +
xlim(-200, 50) + ylim(-350, 50) +
theme_tree()
ggtree(lx_pratchet, layout = "daylight") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_bab[[2]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[3]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[2]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[3]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[2]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[3]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[2]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[3]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[2]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab[[3]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
lx_pratchet <- acctran(lx_pratchet, lx_phy)
lx_pratchet
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-120, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-150, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 150) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 180) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 160) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 120) + ylim(-300, 150) +
theme_tree()
ggtree(lx_pratchet, layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 120) + ylim(-250, 150) +
theme_tree()
plot(lx_upgma)
upgma_tree <- ggtree(lx_upgma) +
geom_tiplab() +
xlim_tree(0.18) +
theme_tree()
upgma_tree
plot(lx_nj, "unrooted")
plot(lx_nj, "tidy")
nj_tree
nj_tree
plot(lx_upgma)
plot(lx_nj, "unrooted")
plot(lx_nj, "tidy")
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.5, .3) +
ylim(-.3, .3) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.5, .3) +
ylim(-.5, .5) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.5, .3) +
ylim(-1, 1) +
theme_tree()
#2.4. neighborNet
lx_nn <- neighborNet(lx_dist)
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.5, .3) +
ylim(-1, 1) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-1, 1) +
ylim(-1, 1) +
theme_tree()
nj_tree
library(tidyverse)
library(phangorn)
library(ggtree)
library(tanggle)
library(TreeTools)
#1. Préparation des données
#1.1. Import
# url <- "https://raw.githubusercontent.com/yuanyang11510/Dissertation-Master-Codes/main/With%20borrowings(3882).tsv"
# download.file(url, "BAI.tsv")
# lx <- read_tsv("BAI.tsv", comment = "#") %>%
lx = read_tsv ("Data/With borrowings(3727).tsv", comment = "#")
library(tidyverse)
library(phangorn)
library(ggtree)
library(tanggle)
library(TreeTools)
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-2, 2) +
ylim(-2, 2) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-1, 1) +
ylim(-1, 1) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.5, .5) +
ylim(-.5, .5) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.3, .3) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.2, .5) +
ylim(-.2, .5) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.4, .3) +
ylim(-.3, .4) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .2) +
ylim(-.3, .4) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.2, .1) +
ylim(-.3, .4) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.2, .2) +
ylim(-.3, .4) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.3, .3) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.2, .4) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.2, .3) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.2, .2) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.3, .2) +
theme_tree()
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.4, .2) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.3, .2) +
theme_tree()
nj_tree
nj_tree <- ggtree(lx_nj, layout = "daylight") +
geom_tiplab2() +
xlim(-.3, .3) +
ylim(-.2, .3) +
theme_tree()
nj_tree
#4. Evaluation
#4.1. Evaluation de la robustesse (UPGMA, bootstrap)
#此处是以2.2.中通过UPGMA得到的谱系树为例，运用bootstrap（自助法）来测试每棵谱系树的每条分支的稳定性
lx_m <- PhyDatToMatrix(lx_phy)
boot_upgma_hamming <- function(x) {
upgma(dist.hamming(phyDat(x, type = "USER", levels = c(0, 1))))
}
n_bs <- 1000
set.seed(123456)
lx_upgma_bs <- boot.phylo(lx_upgma,
lx_m,
boot_upgma_hamming,
B = n_bs,
trees = TRUE,
quiet = TRUE)
upgma_bs_scores <- prop.clades(lx_upgma, lx_upgma_bs$trees, rooted = TRUE)
upgma_support <- c(rep(n_bs, length(lx_phy)), upgma_bs_scores)
upgma_support_pct <- upgma_support / n_bs
ggtree(lx_upgma) +
geom_tiplab() +
geom_nodelab(aes(label = upgma_support_pct), geom = "text", hjust = -.1) +
xlim_tree(0.14) +
theme_tree()
ggtree(lx_upgma) +
geom_tiplab() +
geom_nodelab(aes(label = upgma_support_pct), geom = "text", hjust = -.1) +
xlim_tree(0.2) +
theme_tree()
upgma_support_pct[upgma_support_pct < .7] <- NA
ggtree(lx_upgma) +
geom_tiplab() +
geom_nodelab(aes(label = upgma_support_pct), geom = "text", hjust = -.1) +
xlim_tree(0.2) +
theme_tree()
ggtree(lx_upgma) +
geom_tiplab() +
geom_nodelab(aes(label = upgma_support_pct), geom = "text", hjust = -.1) +
xlim_tree(0.2) +
theme_tree()
ggtree(lx_upgma) +
geom_tiplab() +
geom_nodelab(aes(label = upgma_support_pct), geom = "text", hjust = -.1) +
xlim_tree(0.2) +
theme_tree()
upgma_support_pct[upgma_support_pct < .7] <- NA
upgma_support_pct <- upgma_support / n_bs
ggtree(lx_upgma) +
geom_tiplab() +
geom_nodelab(aes(label = upgma_support_pct), geom = "text", hjust = -.1) +
xlim_tree(0.2) +
theme_tree()
upgma_support_pct[upgma_support_pct < .7] <- NA
ggtree(lx_upgma) +
geom_tiplab() +
geom_nodelab(aes(label = upgma_support_pct), geom = "text", hjust = -.1) +
xlim_tree(0.2) +
theme_tree()
#4.2. Résumer l'accord entre des résultats
lx_bab_consensus <- consensus(lx_bab, p = 1)
ggtree(lx_bab_consensus, layout = "daylight") +
geom_tiplab2() +
xlim(-4.75, 3.85) + ylim(-4.25, 4.75) +
theme_tree()
ggtree(lx_bab_consensus, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-10, 10) +
theme_tree()
lx_bab_consensus_mj <- consensus(lx_bab, p = .5)
ggtree(lx_bab_consensus, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-10, 10) +
theme_tree()
lx_bab_consensus_mj <- consensus(lx_bab, p = .5)
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-10, 10) +
theme_tree()
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-5, 10) + ylim(-10, 10) +
theme_tree()
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-5, 10) + ylim(-15, 10) +
theme_tree()
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-15, 10) +
theme_tree()
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-8, 10) + ylim(-15, 10) +
theme_tree()
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-8, 10) + ylim(-15, 15) +
theme_tree()
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-8, 15) + ylim(-15, 10) +
theme_tree()
library(tidyverse)
library(phangorn)
library(ggtree)
library(tanggle)
library(TreeTools)
library(TreeTools)
ggtree(lx_bab[[1]], layout = "equal_angle") +
geom_tiplab2() +
xlim(-180, 200) + ylim(-150, 150) +
theme_tree()
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-10, 10) +
theme_tree()
#4.2. Résumer l'accord entre des résultats
lx_bab_consensus <- consensus(lx_bab, p = 1)
ggtree(lx_bab_consensus, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-10, 10) +
theme_tree()
library(tidyverse)
library(phangorn)
library(ggtree)
library(tanggle)
library(TreeTools)
#4.2. Résumer l'accord entre des résultats
lx_bab_consensus <- consensus(lx_bab, p = 1)
ggtree(lx_bab_consensus, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-10, 10) +
theme_tree()
lx_bab_consensus_mj <- consensus(lx_bab, p = .5)
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-10, 10) + ylim(-10, 10) +
theme_tree()
lx_bab_consensus_mj <- consensus(lx_bab, p = .5)
ggtree(lx_bab_consensus_mj, layout = "daylight") +
geom_tiplab2() +
xlim(-8, 15) + ylim(-15, 10) +
theme_tree()
